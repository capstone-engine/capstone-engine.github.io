<!DOCTYPE html>
<html>
  <head>
    <title>Twitter-based reversing bot – Capstone – The Ultimate Disassembler</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="The Ultimate Disassembler">
    <meta property="og:description" content="The Ultimate Disassembler" />
    
    <meta name="author" content="Capstone" />

    
    <meta property="og:title" content="Twitter-based reversing bot" />
    <meta property="twitter:title" content="Twitter-based reversing bot" />
    

    <link rel="icon" type="image/png" sizes="16x16" href="/16x16.png">
    <link rel="icon" type="image/png" sizes="24x24" href="/24x24.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/48x48.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/64x64.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/96x96.png">
    <link rel="icon" type="image/png" sizes="128x128" href="/128x128.png">
    <link rel="icon" type="image/png" sizes="256x256" href="/256x256.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/512x512.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">


    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Capstone - The Ultimate Disassembler" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/img/capstone.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Capstone</a></h1>
            <p class="site-description">The Ultimate Disassembler</p>
          </div>

          <nav>
            <a href="/download.html">Download</a>
            <a href="/documentation.html">Docs</a>
            <a href="/showcase.html">Showcase</a>
            <a href="/testimonial.html">Testimonials</a>
            <a href="/donate.html">Donate</a>
            <a href="/contact.html">Contact</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <h2>Reversing in open wide public, on Twitter</h2>

<h3>1. Introduction</h3>

<p><strong>CEbot</strong> is a tool that lets you disassemble binary code from your own Twitter!</p>

<p>How? Do this in 2 simple steps:</p>

<ul>
<li>Send a tweet with your hex string. <em>CEbot</em> supports 2 tweet syntaxes as follows.</li>
</ul>

<ol>
<li><p>Either <em>tweet</em> your hex string with hashtag <strong>#cebot</strong> or <strong>#2ce</strong> (read: &quot;<strong>To-C</strong>apstone-<strong>E</strong>ngine&quot;).</p></li>
<li><p>Or <em>tweet</em> the hex string directly to <strong>@ceb0t</strong>. In this case, the hashtag <em>#cebot</em> (or <em>#2ce</em>) is not needed.</p></li>
</ol>

<p>The first method can be used if you want all of your followers to see your reverse code.</p>

<p>Meanwhile, the second method makes less noise because only those following both you and <em>@ceb0t</em> will see the tweet.</p>

<ul>
<li>Wait 1 ~ 2 seconds, the reversed assembly code will be sent back, also via Twitter. Be sure to check the <em>Notifications</em> tab if you do not see it soon enough.</li>
</ul>

<p><code>NOTE</code>: If you do not see any reply, check the <em>FAQ</em> in <em>section 4</em> below for the possible reasons.</p>

<p><br>
Few examples on tweets accepted by <em>CEbot</em>:</p>

<ul>
<li><strong>x32 909090 #2ce</strong></li>
</ul>

<p>Reverse <em>x86 32-bit</em> code with hex-string of 3 bytes <em>909090</em>. The result sent back would be <em>3 NOP</em> instructions.</p>

<ul>
<li><strong>x64 att 0x90 0x90 0x90 #2ce</strong></li>
</ul>

<p>Reverse <em>x86-64</em> code of the same 3 NOPs, but get back assembly in <em>AT&amp;T syntax</em> (rather than default <em>Intel</em> syntax).</p>

<ul>
<li><strong>arm #cebot &quot;\x04\xe0\x2d\xe5&quot;</strong></li>
</ul>

<p>Reverse ARM code. Note that the hashtag can be put <em>anywhere in the tweet</em>.</p>

<ul>
<li><strong>@ceb0t m64 be 0C,10,00,97</strong></li>
</ul>

<p>Reverse Mips <em>64-bit</em> code in <em>big-endian</em> mode. This time, tweet is directly sent to <em>@ceb0t</em>, and hashtag <em>#2ce</em> is not required.</p>

<p><br>
Readers might already noted that <em>CEbot</em> is flexible with format of the input hex-string: it is perfectly legal to have <em>space</em>, <em>quote</em>, <em>double-quote</em>, <em>comma</em> or even <em>plus sign</em> (<em>+</em>) inside the code.</p>

<p>For now, 8 architectures are supported: <em>Arm</em>, <em>Arm64</em>, <em>Mips</em>, <em>PowerPC</em>, <em>Sparc</em>, <em>SystemZ</em>, <em>XCore</em> &amp; <em>X86</em>. See section 3 below for further details.</p>

<hr>

<h3>2. Real-life example</h3>

<p>A blog entry on <a href="http://toanpv.wordpress.com/2014/03/06/boston-key-party-ctf-deepblue-writeup/">BostonKeyParty CTF 2014</a> has this PowerPC shellcode:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">shellcode_read_exec</span> <span class="o">=</span> <span class="s2">&quot;\x38\xa0\x04\x03&quot;</span>+
                      <span class="s2">&quot;\x30\x05\xfb\xff&quot;</span>+
                      <span class="s2">&quot;\x7c\x24\x0b\x78&quot;</span>+
                      <span class="s2">&quot;\x44\x00\x00\x02&quot;</span>+
                      <span class="s2">&quot;\x69\x69\x69\x69&quot;</span>+
                      <span class="s2">&quot;\x7c\x29\x03\xa6&quot;</span>+
                      <span class="s2">&quot;\x4e\x80\x04\x21&quot;</span></code></pre></div>

<p><br>
The author never explained this shellcode, but we can find out by just copying its content, putting <em>&quot;ppc&quot;</em> in front, then tweet it like below (actually with one <em>plus sign</em> removed to fit everything in a tweet).</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ppc <span class="s2">&quot;\x38\xa0\x04\x03&quot;&quot;\x30\x05\xfb\xff&quot;</span>+<span class="s2">&quot;\x7c\x24\x0b\x78&quot;</span>+<span class="s2">&quot;\x44\x00\x00\x02&quot;</span>+
<span class="s2">&quot;\x69\x69\x69\x69&quot;</span>+<span class="s2">&quot;\x7c\x29\x03\xa6&quot;</span>+<span class="s2">&quot;\x4e\x80\x04\x21&quot;</span> <span class="c">#2ce</span></code></pre></div>

<p><br>
In under 2 seconds, we get back a tweet from <em>@ceb0t</em> with the assembly of the shellcode inside.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">li r5, 0x403
    addic r0, r5, -0x401
    mr r4, r1
    sc 0
    xori r9, r11, 0x6969
    mtctr r1
    bctrl</code></pre></div>

<hr>

<h3>3. Tweet syntax for CEbot</h3>

<p><em>CEbot</em> only serves requests with proper content: the accepted syntax is simple &amp; intuitive, as follows.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>@ceb0t<span class="o">]</span> &lt;arch&gt; <span class="o">[</span>mode1 mode2 ...<span class="o">]</span> <span class="o">[</span>syntax<span class="o">]</span> &lt;hex-string&gt; <span class="o">[</span><span class="c">#2ce|#cebot]</span></code></pre></div>

<p><br>
This means to send the tweet directly to <em>@ceb0t</em>, put its Twitter ID at the front. Then, the first word in the hex-string must indicate the <em>hardware architecture</em>. Next part specifies the <em>hardware modes</em>, <em>assembly syntax</em>, then the input <em>hex-string</em>. It is possible to combine more than one modes, like when we want to reverse Mips code in <em>64-bit</em> &amp; <em>big-endian</em> mode. But if the <em>modes</em> &amp; <em>syntax</em> are missing, the <em>default modes</em> &amp; <em>default syntax</em> will be used.</p>

<p>Note that the hashtag <em>#2ce</em> (or <em>#cebot</em>, but only one of them is needed) can be put anywhere in the tweet, not necessarily at the end. Moreover, if we tweet directly to <em>@ceb0t</em>, hashtag is not required. Vice versa, mass-tweet would need hashtag, but not <em>@ceb0t</em> in front.</p>

<p>Finally, to shorten the tweet contents, <em>CEbot</em> supports <strong>alias</strong>, which combines <em>arch</em> &amp; <em>modes</em>. Example: <em>x32</em> is actually the alias of <em>x86 32</em> (32-bit X86), <em>m64</em> is the alias of <em>mips 64</em> (64-bit Mips)</p>

<p>At the moment, <em>CEbot</em> supports 8 architectures with the following setup.</p>

<p><br>
<strong>X86</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | x86 | X86 architecture |
| mode | 16<br>32<br>64 | 16-bit<br>32-bit (<strong>default mode</strong>)<br>64-bit |
| syntax | intel<br>att | Intel assembly syntax (<strong>default syntax</strong>)<br>AT&amp;T assembly syntax |
| alias | x16<br>x32<br>x64 | x86 16<br>x86 32<br>x86 64 |</p>

<p><br>
<strong>ARM</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | arm | ARM architecture |
| mode | le<br>be<br>thumb | Little endian (<strong>default endian</strong>)<br>Big-endian<br>Thumb mode |</p>

<p><br>
<strong>Thumb (ARM)</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | thumb | Thumb mode of ARM architecture |
| mode | le<br>be<br> | Little endian (<strong>default endian</strong>)<br>Big-endian |</p>

<p><br>
<strong>Arm64</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | arm64 | Arm64 (or Aarch64/ArmV8) architecture |
| mode | le<br>be<br> | Little endian (<strong>default endian</strong>)<br>Big-endian |
| alias | a64 | arm64 |</p>

<p><br>
<strong>Mips</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | mips | Mips architecture |
| mode | 32<br>64<br>le<br>be<br> | 32-bit (<strong>default mode</strong>)<br>64-bit<br>Little endian (<strong>default endian</strong>)<br>Big-endian |
| alias | m32<br>m64 | mips 32<br>mips 64 |</p>

<p><br>
<strong>PowerPC</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | ppc | PowerPC architecture |
| mode | - | No mode specified is needed |</p>

<p><br>
<strong>Sparc</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | sparc | Sparc architecture |
| mode | v9 | Sparc V9 |
| alias | spv9 | sparc v9 |</p>

<p><br>
<strong>SystemZ</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | sysz | SystemZ architecture |
| mode | - | No mode specified is needed |</p>

<p><br>
<strong>XCore</strong></p>

<p>| Field | Value | Meaning |
| :--: |:--:|:--|
| arch | xcore | XCore architecture |
| mode | - | No mode specified is needed |
| alias | xc | xcore |</p>

<hr>

<h3>4. FAQ</h3>

<ul>
<li><p><strong>Why this tool?</strong></p>

<ul>
<li>It can be helpful for those who are on Twitter all the time.</li>
<li>This is the best way to show your reverse kungfu to the world in open wide public :-)</li>
<li>We hope through this more people use Capstone disassembly framework &amp; actively report bugs in it.</li>
<li>It is fun: <em>CEbot</em> is the first ever Twitter-based bot for reversing, no less :-)</li>
</ul></li>
<li><p><strong>How this works?</strong></p></li>
</ul>

<p>Our bot with the Twitter ID <strong>@CEb0t</strong> watches for Twitter stream with hashtags <em>#2ce</em> and <em>#cebot</em> to pick up the requests. Powered by the latest <a href="https://github.com/aquynh/capstone/tree/next">Capstone Engine</a>, this bot reverses the input hex-string, then sends back the assembly to the user via Twitter.</p>

<p>Note that the input code is disassembled with <em>offset 0</em>.</p>

<ul>
<li><strong>I tweeted my hex-string, but saw nothing returned (!?)</strong></li>
</ul>

<p>There are two main reasons when no assembly code is sent back.</p>

<ul>
<li><p><em>CEbot</em> does not pick up requests with wrong format. Perhaps your tweet did not follow the strict syntax introduced in section 3 above. Note that the very first word must be either the hashtag or <em>arch</em>. <em>Do not mention</em> the bot, or any other tweeter ID. The hashtag (either <em>#2ce</em> or <em>#cebot</em>) can be put anywhere, however.</p></li>
<li><p>If you are sure your tweet is correct, perhaps <em>CEbot</em> is not online for some unexpected reasons. Confirm that by checking for its status announced at its <a href="https://twitter.com/ceb0t">Twitter page</a></p>

<p>If you suspect that the bot is died, please report to <a href="https://twitter.com/capstone_engine">@capstone_engine</a> or <a href="https://twitter.com/ceb0t">@ceb0t</a>, we will fix it.</p>

<ul>
<li><strong>Can I receive the output on Direct-Message (DM)?</strong></li>
</ul></li>
</ul>

<p>Too bad, Twitter puts a tight limit on DM: we can only send <em>15 DMs in 15 minutes</em>, and this restriction effectively makes it pretty useless. Therefore, <em>CEbot</em> has to stick with public tweets.</p>

<ul>
<li><strong>Is CEbot disturbing people with public tweets?</strong></li>
</ul>

<p><em>CEbot</em> only answers requests having hashtags <em>#2ce</em> or <em>#cebot#</em>, plus the tweet content must strictly follows the syntax presented in section 3 above. It is unlikely that usual tweets meet these requirements. Therefore, there is little chance that <em>CEbot</em> will bother those who do not explicitly ask for its service.</p>

<ul>
<li><strong>Any limitations of this bot?</strong></li>
</ul>

<p>The main issue comes from Twitter itself, as users can only send in short hex-strings: keep in mind that Twitter allows <em>no more than 140 chars</em> in a tweet.</p>

<p>In return, we walkaround this limit by sending back the assembly on Twitter only if the output is <em>shorter than 140 chars</em>. With longer code, we post the result on <em>Pastebin.com</em>, then send back the link instead.</p>

<!---
  Finally, Twitter caps the number of tweets a bot can send daily at 1000. For this reason, when reaching this limit, *CEbot* will have to wait for the timeout. We took some measures to prevent spams, but please do not abuse *CEbot* by sending too many requests a day. 
-->

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:capstone.engine@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/aquynh/capstone"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/capstone_engine"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  </body>
</html>
