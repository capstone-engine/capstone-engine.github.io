<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Capstone - Twitter-based reversing bot</title><link rel="stylesheet" href="css/style.css" type="text/css" media="all"><link rel="stylesheet" href="css/pygments.css" type="text/css" media="all"><link rel="alternate" href="feed/index.xml" type="application/atom+xml" title="Atom Feed"></head><body><div id="fb-root"></div> <script>!function(e,t,n){var c,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(c=e.createElement(t),c.id=n,c.src="//connect.facebook.net/en_US/all.js#xfbml=1",o.parentNode.insertBefore(c,o))}(document,"script","facebook-jssdk")</script><script>!function(t,e,r){var n,s=t.getElementsByTagName(e)[0],i=/^http:/.test(t.location)?"http":"https";t.getElementById(r)||(n=t.createElement(e),n.id=r,n.src=i+"://platform.twitter.com/widgets.js",s.parentNode.insertBefore(n,s))}(document,"script","twitter-wjs")</script><script>!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://apis.google.com/js/plusone.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="page"> <header> <a href="index.html" id="cs_home">Capstone</a> <nav> <a href="index.html">Home</a> <a href="download.html">Download</a> <a href="documentation.html">Docs</a> <a href="showcase.html">Showcase</a> <a href="testimonial.html">Testimonials</a> <a href="donation.html">Donate</a> <a href="contact.html">Contact</a> </nav> </header> <section><h2 id="reversing-in-open-wide-public-on-twitter">Reversing in open wide public, on Twitter</h2><h3 id="introduction">1. Introduction</h3><p><strong>CEbot</strong> is a tool that lets you disassemble binary code from your own Twitter!</p><p>How? Do this in 2 simple steps:</p><ul><li><p>Send a tweet with your hex string. <em>CEbot</em> supports 2 tweet syntaxes as followings.</p><ol><li><p>Either <em>tweet</em> your hex string with hashtag <strong>#cebot</strong> or <strong>#2ce</strong> (read: “<strong>To-C</strong>apstone-<strong>E</strong>ngine”).</p></li><li><p>Or <em>tweet</em> the hex string directly to <strong>@ceb0t</strong>. In this case, the hashtag <em>#cebot</em> (or <em>#2ce</em>) is not needed.</p></li></ol><p>The first method can be used if you want all of your followers to see your reverse code.</p><p>Meanwhile, the second method makes less noise because only those following both you and <em>@ceb0t</em> will see the tweet.</p></li><li><p>Wait 1 ~ 2 seconds, the reversed assembly code will be sent back, also via Twitter. Be sure to check the <em>Notifications</em> tab if you do not see it soon enough.</p><p><code>NOTE</code>: If you do not see any reply, check the <em>FAQ</em> in <em>section 4</em> below for the possible reasons.</p></li></ul><p><br/> Few examples on tweets accepted by <em>CEbot</em>:</p><ul><li><p><strong>x32 909090 #2ce</strong></p><p>Reverse <em>x86 32-bit</em> code with hex-string of 3 bytes <em>909090</em>. The result sent back would be <em>3 NOP</em> instructions.</p></li><li><p><strong>x64 att 0x90 0x90 0x90 #2ce</strong></p><p>Reverse <em>x86-64</em> code of the same 3 NOPs, but get back assembly in <em>AT&amp;T syntax</em> (rather than default <em>Intel</em> syntax).</p></li><li><p><strong>arm #cebot “\x04\xe0\x2d\xe5”</strong></p><p>Reverse ARM code. Note that the hashtag can be put <em>anywhere in the tweet</em>.</p></li><li><p><strong>@ceb0t m64 be 0C,10,00,97</strong></p><p>Reverse Mips <em>64-bit</em> code in <em>big-endian</em> mode. This time, tweet is directly sent to <em>@ceb0t</em>, and hashtag <em>#2ce</em> is not required.</p></li></ul><p><br/> Readers might already noted that <em>CEbot</em> is flexible with format of the input hex-string: it is perfectly legal to have <em>space</em>, <em>quote</em>, <em>double-quote</em>, <em>comma</em> or even <em>plus sign</em> (<em>+</em>) inside the code.</p><p>For now, 8 architectures are supported: <em>Arm</em>, <em>Arm64</em>, <em>Mips</em>, <em>PowerPC</em>, <em>Sparc</em>, <em>SystemZ</em>, <em>XCore</em> &amp; <em>X86</em>. See section 3 below for further details.</p><hr/><p>### 2. Real-life example A blog entry on <a href="http://toanpv.wordpress.com/2014/03/06/boston-key-party-ctf-deepblue-writeup/">BostonKeyParty CTF 2014</a> has this PowerPC shellcode:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">shellcode_read_exec</span> <span class="o">=</span> <span class="s2">"\x38\xa0\x04\x03"</span>+
                      <span class="s2">"\x30\x05\xfb\xff"</span>+
                      <span class="s2">"\x7c\x24\x0b\x78"</span>+
                      <span class="s2">"\x44\x00\x00\x02"</span>+
                      <span class="s2">"\x69\x69\x69\x69"</span>+
                      <span class="s2">"\x7c\x29\x03\xa6"</span>+
                      <span class="s2">"\x4e\x80\x04\x21"</span></code></pre></div><p><br/> The author never explained this shellcode, but we can find out by just copying its content, putting <em>“ppc”</em> in front, then tweet it like below (actually with one <em>plus sign</em> removed to fit everything in a tweet).</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">ppc <span class="s2">"\x38\xa0\x04\x03""\x30\x05\xfb\xff"</span>+<span class="s2">"\x7c\x24\x0b\x78"</span>+<span class="s2">"\x44\x00\x00\x02"</span>+
<span class="s2">"\x69\x69\x69\x69"</span>+<span class="s2">"\x7c\x29\x03\xa6"</span>+<span class="s2">"\x4e\x80\x04\x21"</span> <span class="c">#2ce</span></code></pre></div><p><br/> In under 2 seconds, we get back a tweet from <em>@ceb0t</em> with the assembly of the shellcode inside.</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">li r5, 0x403
	addic r0, r5, -0x401
	mr r4, r1
	sc 0
	xori r9, r11, 0x6969
	mtctr r1
	bctrl</code></pre></div><hr/><p>### 3. Tweet syntax for CEbot</p><p><em>CEbot</em> only serves requests with proper content: the accepted syntax is simple &amp; intuitive, as followings.</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>@ceb0t<span class="o">]</span> &lt;arch&gt; <span class="o">[</span>mode1 mode2 ...<span class="o">]</span> <span class="o">[</span>syntax<span class="o">]</span> &lt;hex-string&gt; <span class="o">[</span><span class="c">#2ce|#cebot]</span></code></pre></div><p><br/> This means to send the tweet directly to <em>@ceb0t</em>, put its Twitter ID at the front. Then, the first word in the hex-string must indicate the <em>hardware architecture</em>. Next part specifies the <em>hardware modes</em>, <em>assembly syntax</em>, then the input <em>hex-string</em>. It is possible to combine more than one modes, like when we want to reverse Mips code in <em>64-bit</em> &amp; <em>big-endian</em> mode. But if the <em>modes</em> &amp; <em>syntax</em> are missing, the <em>default modes</em> &amp; <em>default syntax</em> will be used.</p><p>Note that the hashtag <em>#2ce</em> (or <em>#cebot</em>, but only one of them is needed) can be put anywhere in the tweet, not necessarily at the end. Moreover, if we tweet directly to <em>@ceb0t</em>, hashtag is not required. Vice versa, mass-tweet would need hashtag, but not <em>@ceb0t</em> in front.</p><p>Finally, to shorten the tweet contents, <em>CEbot</em> supports <strong>alias</strong>, which combines <em>arch</em> &amp; <em>modes</em>. Example: <em>x32</em> is actually the alias of <em>x86 32</em> (32-bit X86), <em>m64</em> is the alias of <em>mips 64</em> (64-bit Mips)</p><p>At the moment, <em>CEbot</em> supports 8 architectures with the following setup.</p><p><br/> <strong>X86</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">x86</td><td style="text-align:left">X86 architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">16<br/>32<br/>64</td><td style="text-align:left">16-bit<br/>32-bit (<strong>default mode</strong>)<br/>64-bit</td></tr><tr><td style="text-align:center">syntax</td><td style="text-align:center">intel<br/>att</td><td style="text-align:left">Intel assembly syntax (<strong>default syntax</strong>)<br/>AT&amp;T assembly syntax</td></tr><tr><td style="text-align:center">alias</td><td style="text-align:center">x16<br/>x32<br/>x64</td><td style="text-align:left">x86 16<br/>x86 32<br/>x86 64</td></tr></tbody></table><p><br/> <strong>ARM</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">arm</td><td style="text-align:left">ARM architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">le<br/>be<br/>thumb</td><td style="text-align:left">Little endian (<strong>default endian</strong>)<br/>Big-endian<br/>Thumb mode</td></tr></tbody></table><p><br/> <strong>Thumb (ARM)</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">thumb</td><td style="text-align:left">Thumb mode of ARM architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">le<br/>be<br/></td><td style="text-align:left">Little endian (<strong>default endian</strong>)<br/>Big-endian</td></tr></tbody></table><p><br/> <strong>Arm64</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">arm64</td><td style="text-align:left">Arm64 (or Aarch64/ArmV8) architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">le<br/>be<br/></td><td style="text-align:left">Little endian (<strong>default endian</strong>)<br/>Big-endian</td></tr><tr><td style="text-align:center">alias</td><td style="text-align:center">a64</td><td style="text-align:left">arm64</td></tr></tbody></table><p><br/> <strong>Mips</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">mips</td><td style="text-align:left">Mips architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">32<br/>64<br/>le<br/>be<br/></td><td style="text-align:left">32-bit (<strong>default mode</strong>)<br/>64-bit<br/>Little endian (<strong>default endian</strong>)<br/>Big-endian</td></tr><tr><td style="text-align:center">alias</td><td style="text-align:center">m32<br/>m64</td><td style="text-align:left">mips 32<br/>mips 64</td></tr></tbody></table><p><br/> <strong>PowerPC</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">ppc</td><td style="text-align:left">PowerPC architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">-</td><td style="text-align:left">No mode specified is needed</td></tr></tbody></table><p><br/> <strong>Sparc</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">sparc</td><td style="text-align:left">Sparc architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">v9</td><td style="text-align:left">Sparc V9</td></tr><tr><td style="text-align:center">alias</td><td style="text-align:center">spv9</td><td style="text-align:left">sparc v9</td></tr></tbody></table><p><br/> <strong>SystemZ</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">sysz</td><td style="text-align:left">SystemZ architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">-</td><td style="text-align:left">No mode specified is needed</td></tr></tbody></table><p><br/> <strong>XCore</strong></p><table><thead><tr><th style="text-align:center">Field</th><th style="text-align:center">Value</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:center">arch</td><td style="text-align:center">xcore</td><td style="text-align:left">XCore architecture</td></tr><tr><td style="text-align:center">mode</td><td style="text-align:center">-</td><td style="text-align:left">No mode specified is needed</td></tr><tr><td style="text-align:center">alias</td><td style="text-align:center">xc</td><td style="text-align:left">xcore</td></tr></tbody></table><hr/><p>### 4. FAQ</p><ul><li><p><strong>Why this tool?</strong></p><ul><li><p>It can be helpful for those who are on Twitter all the time.</p></li><li><p>This is the best way to show your reverse kungfu to the world in open wide public :-)</p></li><li><p>We hope through this more people use Capstone disassembly framework &amp; actively report bugs in it.</p></li><li><p>It is fun: <em>CEbot</em> is the first ever Twitter-based bot for reversing, no less :-)</p></li></ul></li><li><p><strong>How this works?</strong></p><p>Our bot with the Twitter ID <strong>@CEb0t</strong> watches for Twitter stream with hashtags <em>#2ce</em> and <em>#cebot</em> to pick up the requests. Powered by the latest <a href="https://github.com/aquynh/capstone/tree/next">Capstone Engine</a>, this bot reverses the input hex-string, then sends back the assembly to the user via Twitter.</p><p>Note that the input code is disassembled with <em>offset 0</em>.</p></li><li><p><strong>I tweeted my hex-string, but saw nothing returned (!?)</strong></p><p>There are two main reasons when no assembly code is sent back.</p><ul><li><p><em>CEbot</em> does not pick up requests with wrong format. Perhaps your tweet did not follow the strict syntax introduced in section 3 above. Note that the very first word must be either the hashtag or <em>arch</em>. <em>Do not mention</em> the bot, or any other tweeter ID. The hashtag (either <em>#2ce</em> or <em>#cebot</em>) can be put anywhere, however.</p></li><li><p>If you are sure your tweet is correct, perhaps <em>CEbot</em> is not online for some unexpected reasons. Confirm that by checking for its status announced at its <a href="https://twitter.com/ceb0t">Twitter page</a></p><p>If you suspect that the bot is died, please report to <a href="https://twitter.com/capstone_engine">@capstone_engine</a> or <a href="https://twitter.com/ceb0t">@ceb0t</a>, we will fix it.</p></li></ul></li><li><p><strong>Can I receive the output on Direct-Message (DM)?</strong></p><p>Too bad, Twitter puts a tight limit on DM: we can only send <em>15 DMs in 15 minutes</em>, and this restriction effectively makes it pretty useless. Therefore, <em>CEbot</em> has to stick with public tweets.</p></li><li><p><strong>Is CEbot disturbing people with public tweets?</strong></p><p><em>CEbot</em> only answers requests having hashtags <em>#2ce</em> or <em>#cebot#</em>, plus the tweet content must strictly follows the syntax presented in section 3 above. It is unlikely that usual tweets meet these requirements. Therefore, there is little chance that <em>CEbot</em> will bother those who do not explicitly ask for its service.</p></li><li><p><strong>Any limitations of this bot?</strong></p><p>The main issue comes from Twitter itself, as users can only send in short hex-strings: keep in mind that Twitter allows <em>no more than 140 chars</em> in a tweet.</p><p>In return, we walkaround this limit by sending back the assembly on Twitter only if the output is <em>shorter than 140 chars</em>. With longer code, we post the result on <em>Pastebin.com</em>, then send back the link instead.</p></li></ul></section> <footer> </footer></div></body></html>